<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anketa</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  background: radial-gradient(circle at top, #f9fafb, #eef1f6);
  min-height: 100vh;
  overflow: hidden;
  color: #1f2937;
}

/* LEPTIRI */
.butterfly {
  position: fixed;
  width: 60px;
  opacity: 0.25;
  pointer-events: none;
  animation: drift linear infinite;
}

@keyframes drift {
  from { transform: translate(0,0); }
  to { transform: translate(var(--dx), var(--dy)); }
}

/* LAYOUT */
.wrapper {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

/* CARD */
.card {
  width: 100%;
  max-width: 440px;
  padding: 28px 26px;
  border-radius: 22px;
  background: rgba(255,255,255,0.82);
  backdrop-filter: blur(14px);
  box-shadow:
    0 30px 60px rgba(0,0,0,0.18),
    inset 0 1px 0 rgba(255,255,255,0.6);
  text-align: center;
  z-index: 10;
}

/* STEP */
.step {
  display: none;
  opacity: 0;
  transform: translateY(24px);
}

.step.active {
  display: block;
  animation: stepIn 0.5s cubic-bezier(.2,.8,.2,1) forwards;
}

@keyframes stepIn {
  to { opacity: 1; transform: translateY(0); }
}

/* TYPO */
h2 { font-size: 22px; margin-bottom: 18px; }
h3 { font-size: 18px; margin-bottom: 14px; }
h4 { font-size: 15px; margin: 10px 0; font-weight: 600; }

/* BUTTONS */
button {
  width: 100%;
  padding: 14px 16px;
  margin: 8px 0;
  border-radius: 14px;
  border: none;
  font-size: 16px;
  cursor: pointer;
}

button:not(.secondary) {
  background: linear-gradient(135deg, #2563eb, #3b82f6);
  color: #fff;
}

.secondary {
  background: #f1f5f9;
  color: #1f2937;
}

/* SELECT */
select {
  width: 100%;
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid #d1d5db;
  font-size: 16px;
}

/* SECTION */
.section {
  margin-top: 14px;
  padding: 12px;
  border-radius: 14px;
  background: #fff;
  text-align: left;
}

.option {
  margin: 8px 0;
}

.option a {
  margin-left: 6px;
  font-size: 13px;
  color: #2563eb;
  text-decoration: none;
}

/* TEXTAREA */
textarea {
  width: 100%;
  margin-top: 14px;
  padding: 14px;
  border-radius: 14px;
  border: 1px solid #d1d5db;
  font-size: 15px;
  resize: none;
}
</style>
</head>

<body>

<div class="wrapper">
  <div class="card">

    <!-- STEP 0 -->
    <div id="step0" class="step active">
      <h2>Provera identiteta ü§ñ</h2>
      <label style="display:flex;justify-content:center;gap:10px;font-size:16px;cursor:pointer;">
        <input type="checkbox" id="fakeCaptcha" onchange="fakeCaptchaCheck()">
        Nisam robot
      </label>
    </div>

    <!-- STEP 1 -->
    <div id="step1" class="step">
      <h2>Da li si raspolo≈æena da izaƒëe≈° sa mnom ove nedelje na piƒáe ili veƒçeru?‚ò∫Ô∏è</h2>
      <button onclick="answer('Da')">Da</button>
      <button class="secondary" onclick="answer('Ne')">Ne</button>
    </div>

    <!-- STEP 2 -->
    <div id="step2" class="step">
      <h3>Koji dan ti najvi≈°e odgovara?</h3>
      <select id="day">
        <option>Ponedeljak</option>
        <option>Utorak</option>
        <option>Sreda</option>
        <option>ƒåetvrtak</option>
        <option>Petak</option>
        <option>Subota</option>
        <option>Nedelja</option>
      </select>
      <button onclick="nextStep()">Dalje</button>
    </div>

    <!-- STEP 3 -->
    <div id="step3" class="step">
      <h3>Izaberi mesto üçΩÔ∏è</h3>

      <button class="secondary" onclick="toggleSection('kafic')">‚òï Kafiƒái</button>
      <button class="secondary" onclick="toggleSection('restoran')">üçΩ Restorani</button>
      <button class="secondary" onclick="toggleSection('picerija')">üçï Picerije</button>

      <div id="sections"></div>

      <textarea id="predlog" placeholder="Ili predlo≈æi ne≈°to drugo‚Ä¶" rows="3"
        oninput="checkFinishVisibility()"></textarea>

      <button id="finishBtn" onclick="finish()" style="display:none">Zavr≈°i</button>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<script>
emailjs.init("9l5rh_uOr9onl3Z-Y");

let result = {};
let selectedPlace = "";
let openSections = {};

const locations = {
  kafic: [
    ["Kafeterija Fontana","https://maps.app.goo.gl/FSLNB2UZPP8n2JGt5"],
    ["Voulez-vous","https://maps.app.goo.gl/Zs6TKub1mgeKqEhm6"]
  ],
  restoran: [
    ["Durmitor","https://maps.app.goo.gl/TypmyoXyiCQU7Wtv6"],
    ["Milky","https://maps.app.goo.gl/8u4hUeLdapRCSxT19"],
    ["Mamagayo","https://maps.app.goo.gl/cjnhWabUYBGbvtDV9"]
  ],
  picerija: [
    ["Pizza Bar","https://maps.app.goo.gl/RuUrapsaFnpSRRSS8"],
    ["Majstor i Margarita","https://maps.app.goo.gl/L39RkHQiEpSXjuoU8"],
    ["Napoli Picerija","https://maps.app.goo.gl/Q1P4wWc4nYXT6t987"]
  ]
};

function switchStep(from,to){
  document.getElementById(from).classList.remove("active");
  document.getElementById(to).classList.add("active");
}

function createButterflies(){
  for(let i=0;i<40;i++){
    const b=document.createElement("img");
    b.src="leptir.png";
    b.className="butterfly";
    b.style.top=Math.random()*100+"%";
    b.style.left=Math.random()*100+"%";
    b.style.setProperty("--dx",(Math.random()*200-100)+"vw");
    b.style.setProperty("--dy",(Math.random()*200-100)+"vh");
    b.style.animationDuration=(80+Math.random()*40)+"s";
    document.body.appendChild(b);
  }
}

function fakeCaptchaCheck(){
  const cb=document.getElementById("fakeCaptcha");
  if(cb && cb.checked){
    createButterflies();
    switchStep("step0","step1");
  }
}

function answer(val){
  result.odgovor=val;
  if(val==="Da") switchStep("step1","step2");
  else{
    result.dan="-"; result.mesto="-"; result.predlog="-";
    sendResult();
  }
}

function nextStep(){
  result.dan=document.getElementById("day").value;
  switchStep("step2","step3");
}

function toggleSection(type){
  const container=document.getElementById("sections");
  if(openSections[type]){
    openSections[type].remove();
    delete openSections[type];
  } else {
    const s=document.createElement("div");
    s.className="section";
    s.innerHTML=`<h4>${type}</h4>`;
    locations[type].forEach(p=>{
      s.innerHTML+=`
        <div class="option">
          <input type="radio" name="place" onchange="selectedPlace='${p[0]}'">
          ${p[0]} <a href="${p[1]}" target="_blank">mapa</a>
        </div>`;
    });
    openSections[type]=s;
    container.appendChild(s);
  }
  checkFinishVisibility();
}

function checkFinishVisibility(){
  document.getElementById("finishBtn").style.display=
    (Object.keys(openSections).length ||
     document.getElementById("predlog").value.trim()) ? "block" : "none";
}

function finish(){
  result.mesto=selectedPlace||"-";
  result.predlog=document.getElementById("predlog").value.trim()||"-";
  sendResult();
}

function sendResult(){
  emailjs.send("service_wla37zd","template_gjqzphl",result)
  .then(()=>{
    document.querySelector(".card").innerHTML=
      "<h2>Hvala ti üòä</h2><p>Radujem se na≈°em viƒëenju, hajde da priƒçamo üòâ</p>";
  });
}
</script>

</body>
</html>
